<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Armbian team" name="author"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Advanced Features - Armbian Documentation</title>
<link href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet"/>
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet"/>
<script>
    // Current page data
    var mkdocs_page_name = "Advanced Features";
    var mkdocs_page_input_path = "User-Guide_Advanced-Features.md";
    var mkdocs_page_url = null;
  </script>
<script defer="" src="../js/jquery-2.1.1.min.js"></script>
<script defer="" src="../js/modernizr-2.8.3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-284946-9', 'docs.armbian.com');
      ga('send', 'pageview');
  </script>
</link><link href="../pdf/document.pdf" rel="alternate" title="PDF" type="application/pdf"/></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> Armbian Documentation</a>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="..">Home</a>
</li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Getting-Started/">Getting Started</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Quick_facts/">Quick facts</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Basic-Troubleshooting/">Troubleshooting</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="./">Advanced Features</a>
<ul class="current">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Fine-Tuning/">Fine Tuning</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Armbian-Config/">Armbian config</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Allwinner_overlays/">Allwinner DT overlays</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../User-Guide_Migration_from_Bananian/">Migration from Bananian</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Hardware Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Allwinner/">Allwinner (Generic)</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Allwinner-A20/">A10 and A20</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Allwinner-H3/">H2+ and H3</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Allwinner-H5-A64/">H5 and A64</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Allwinner-H6/">H6</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Freescale-imx6/">Freescale i.MX6</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hardware_Marvell/">Marvell Armada</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_Build-Preparation/">Building Armbian</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_Using-Vagrant/">Building with Vagrant</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_Building-with-Docker/">Building with Docker</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_Build-Options/">Build Options</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_User-Configurations/">User Configurations</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Developer-Guide_FEL-boot/">FEL boot</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Contributor Process</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Process_Contribute/">Contribute</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Process_Merge-Policy/">Merge Policy</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Process_Documentation/">Documentation</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Release management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Process_Release-Model/">Model</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Release_Changelog/">Changelog</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Community_IRC/">IRC</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">Armbian Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a href="..">Docs</a> »</li>
<li>User Guide »</li>
<li>Advanced Features</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/armbian/documentation/edit/master/docs/User-Guide_Advanced-Features.md"> Edit on Github</a>
</li>
</ul>
<hr/>
</div>
<div role="main">
<div class="section">
<h3 id="how-to-switch-kernels">How to switch kernels?<a class="headerlink" href="#how-to-switch-kernels" title="Permanent link">¶</a></h3>
<p>Check <a href="http://www.armbian.com/kernel/"><em>this</em></a> for more info.</p>
<h3 id="how-to-troubleshoot">How to troubleshoot?<a class="headerlink" href="#how-to-troubleshoot" title="Permanent link">¶</a></h3>
<p><strong>Important: If you came here since you cannot get Armbian running on your board please keep in mind that in 95 percent of all cases it is either a faulty/fraud/counterfeit SD card or an insufficient power supply that is causing these sorts of <em>does not work</em> issues!</strong></p>
<p>If you broke the system you can try to get in this way. You have to get to u-boot command prompt, using either a serial adapter or monitor and usb keyboard (USB support in u-boot currently not enabled on all H3 boards).</p>
<p>After switching power on or rebooting, when u-boot loads up, press some key on the keyboard (or send some key presses via terminal) to abort default boot sequence and get to the command prompt:</p>
<pre><code>U-Boot SPL 2015.07-dirty (Oct 01 2015 - 15:05:21)
...
Hit any key to stop autoboot:  0
sunxi#
</code></pre>
<p>Enter these commands, replacing root device path if necessary. Select setenv line with ttyS0 for serial, tty1 for keyboard+monitor (these are for booting with mainline kernel, check boot.cmd for your device for commands related to legacy kernel):</p>
<pre><code>setenv bootargs init=/bin/bash root=/dev/mmcblk0p1 rootwait console=ttyS0,115200
# or
setenv bootargs init=/bin/bash root=/dev/mmcblk0p1 rootwait console=tty1

ext4load mmc 0 0x49000000 /boot/dtb/${fdtfile}
ext4load mmc 0 0x46000000 /boot/zImage
env set fdt_high ffffffff
bootz 0x46000000 - 0x49000000
</code></pre>
<p>System should eventually boot to bash shell:</p>
<pre><code>root@(none):/#
</code></pre>
<p>Now you can try to fix your broken system.</p>
<h3 id="how-to-unbrick-the-system-outdated">How to unbrick the system? (outdated)<a class="headerlink" href="#how-to-unbrick-the-system-outdated" title="Permanent link">¶</a></h3>
<p>When something goes terribly wrong and you are not able to boot the system, this is the way to proceed. You need some Linux machine where you can mount the failed SD card. With this procedure you will reinstall the u-boot, kernel and hardware settings. In most cases this should be enough to unbrick the board. It is recommended to issue a filesystem check before mounting:</p>
<pre><code>fsck /dev/sdX -f
</code></pre>
<p>Then mount the SD card and download those files (This example is only for Banana R1):</p>
<pre><code>http://apt.armbian.com/pool/main/l/linux-trusty-root-current-lamobo-r1/linux-trusty-root-current-lamobo-r1_4.5_armhf.deb
http://apt.armbian.com/pool/main/l/linux-upstream/linux-image-current-sunxi_4.5_armhf.deb
http://apt.armbian.com/pool/main/l/linux-upstream/linux-firmware-image-current-sunxi_4.5_armhf.deb
http://apt.armbian.com/pool/main/l/linux-upstream/linux-dtb-current-sunxi_4.5_armhf.deb
</code></pre>
<p>This is just an example for: <strong>Ubuntu Trusty, Lamobo R1, mainline kernel</strong> (next). Alter packages naming according to <a href="https://forum.armbian.com/topic/211-kernel-update-procedure-has-been-changed/">this</a>.</p>
<p>Mount SD card and extract all those deb files to it’s mount point.</p>
<pre><code>dpkg -x DEB_FILE /mnt
</code></pre>
<p>Go to /mnt/boot and link (or copy) <strong>vmlinuz-4.x.x-sunxi</strong> kernel file to <strong>zImage</strong>.</p>
<p>If you upgrade from some very old build, you might need to update your boot script. Example goes for Allwinner boards:</p>
<pre><code>cd /mnt/boot
wget https://raw.githubusercontent.com/armbian/build/master/config/bootscripts/boot-sunxi.cmd
mv boot-sunxi.cmd boot.cmd
mkimage -C none -A arm -T script -d boot.cmd boot.scr # you need a u-boot-tools package on your host system
</code></pre>
<p>Unmount SD card, move it to the board and power on.</p>
<h3 id="how-to-build-a-wireless-driver">How to build a wireless driver?<a class="headerlink" href="#how-to-build-a-wireless-driver" title="Permanent link">¶</a></h3>
<p>Install and recreate kernel headers scripts (optional)</p>
<pre><code>armbian-config -&gt; install kernel headers
exit

cd /usr/src/linux-headers-$(uname -r)
make scripts
</code></pre>
<p>Go back to root directory and fetch sources (working example, use ARCH=arm64 on 64bit system)</p>
<pre><code>cd
git clone https://github.com/pvaret/rtl8192cu-fixes.git
cd rtl8192cu-fixes
make ARCH=arm
</code></pre>
<p>Load driver for test</p>
<pre><code>insmod 8192cu.ko
</code></pre>
<p>Check dmesg and the last entry will be:</p>
<pre><code>usbcore: registered new interface driver rtl8192cu
</code></pre>
<p>Plug the USB wireless adaptor and issue a command:</p>
<pre><code>iwconfig wlan0
</code></pre>
<p>You should see this:</p>
<pre><code>wlan0   unassociated  Nickname:"&lt;WIFI@REALTEK&gt;"
        Mode:Auto  Frequency=2.412 GHz  Access Point: Not-Associated
        Sensitivity:0/0
        Retry:off   RTS thr:off   Fragment thr:off
        Encryption key:off
        Power Management:off
        Link Quality=0/100  Signal level=0 dBm  Noise level=0 dBm
        Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
        Tx excessive retries:0  Invalid misc:0   Missed beacon:0
</code></pre>
<p>Check which wireless stations / routers are in range</p>
<pre><code>iwlist wlan0 scan | grep ESSID
</code></pre>
<h4 id="how-to-freeze-your-filesystem-outdated">How to freeze your filesystem? (outdated)<a class="headerlink" href="#how-to-freeze-your-filesystem-outdated" title="Permanent link">¶</a></h4>
<p>In certain situations it is desirable to have a virtual read-only root filesystem. This prevents any changes from occurring on the root filesystem that may alter system behavior and it allows a simple reboot to restore a system to its clean state.</p>
<p>You need an ODROID XU4 or Allwinner A10, A20 or H3 board with legacy kernel where we added support for overlayfs. Works only on Ubuntu Xenial. Login as root and execute:</p>
<pre><code>apt-get install overlayroot
echo 'overlayroot="tmpfs"' &gt;&gt; /etc/overlayroot.conf
reboot
</code></pre>
<p>After your system boots up it will always remain as is. If you want to make any permanent changes, you need to run:</p>
<pre><code>overlayroot-chroot
</code></pre>
<p>Changes inside this will be preserved.</p>
<h3 id="how-to-run-docker-outdated">How to run Docker? (outdated)<a class="headerlink" href="#how-to-run-docker-outdated" title="Permanent link">¶</a></h3>
<p>Preinstallation requirements:</p>
<ul>
<li>Armbian 5.1 or newer with Kernel 3.10 or higher</li>
<li>Debian Jessie (might work elsewhere with some modifications)</li>
<li>root access</li>
</ul>
<p>Execute this as root:</p>
<pre><code>curl  https://get.docker.com | sh
</code></pre>
<p>Test if Docker works correctly:</p>
<pre><code>docker run -d -p 80:80 hypriot/rpi-busybox-httpd
</code></pre>
<p>… and point the browser of any device in the same network to <code>http://&lt;IP OF YOUR DEVICE&gt;/</code></p>
<p><a href="https://forum.armbian.com/topic/490-docker-on-armbian/">More info in this forum topic</a></p>
<h1 id="how-to-set-wireless-access-point">How to set wireless access point?<a class="headerlink" href="#how-to-set-wireless-access-point" title="Permanent link">¶</a></h1>
<p>There are two different HostAP daemons. One is <strong>default</strong> and the other one is for some <strong>Realtek</strong> wifi cards. Both have their own basic configurations and both are patched to gain maximum performances.</p>
<p>Sources: <a href="https://github.com/igorpecovnik/hostapd" title="https://github.com/igorpecovnik/hostapd">https://github.com/igorpecovnik/hostapd</a></p>
<p>Default binary and configuration location:</p>
<pre><code>/usr/sbin/hostapd
/etc/hostapd.conf
</code></pre>
<p>Realtek binary and configuration location:</p>
<pre><code>/usr/sbin/hostapd-rt
/etc/hostapd.conf-rt
</code></pre>
<p>Since its hard to define when to use which you always try both combinations in case of troubles. To start AP automatically:</p>
<ol>
<li>Edit /etc/init.d/hostapd and add/alter location of your conf file <strong>DAEMON_CONF=/etc/hostapd.conf</strong> and binary <strong>DAEMON_SBIN=/usr/sbin/hostapd</strong></li>
<li>Copy <strong>/etc/network/interfaces.hostapd</strong> to <strong>/etc/network/interfaces</strong></li>
<li>Reboot</li>
<li>Predefined network name: “BOARD NAME” password: 12345678</li>
<li>To change parameters, edit /etc/hostapd.conf BTW: You can get WPAPSK the long blob from wpa_passphrase YOURNAME YOURPASS</li>
</ol>
<h1 id="how-to-connect-ir-remote">How to connect IR remote?<a class="headerlink" href="#how-to-connect-ir-remote" title="Permanent link">¶</a></h1>
<p>Required conditions:</p>
<ul>
<li>IR hardware</li>
<li>loaded driver</li>
</ul>
<p>Get your <a href="http://lirc.sourceforge.net/remotes/">remote configuration</a> (lircd.conf) or <a href="http://kodi.wiki/view/HOW-TO:Setup_Lirc#Learning_Commands">learn</a>. You are going to need the list of all possible commands which you can map to your IR remote keys:</p>
<pre><code>irrecord --list-namespace
</code></pre>
<p>To start with learning process you need to delete old config:</p>
<pre><code>rm /etc/lircd.conf
</code></pre>
<p>Than start the process with:</p>
<pre><code>irrecord --driver=default --device=/dev/lirc0 /etc/lircd.conf
</code></pre>
<p>And finally start your service when done with learning:</p>
<pre><code>service lirc start
</code></pre>
<p>Test your remote:</p>
<pre><code>irw /dev/lircd
</code></pre>
<hr/>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-right" href="../User-Guide_Fine-Tuning/" title="Fine Tuning">Next <span class="icon icon-circle-arrow-right"></span></a>
<a class="btn btn-neutral" href="../User-Guide_Basic-Troubleshooting/" title="Troubleshooting"><span class="icon icon-circle-arrow-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../User-Guide_Basic-Troubleshooting/" style="color: #fcfcfc;">« Previous</a></span>
<span style="margin-left: 15px"><a href="../User-Guide_Fine-Tuning/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
